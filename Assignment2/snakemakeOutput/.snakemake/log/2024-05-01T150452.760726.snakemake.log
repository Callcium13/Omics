Building DAG of jobs...
Using shell: /lustre1/project/stg_00079/teaching/I0U19a_conda_2024/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job stats:
job             count
------------  -------
all                 1
extract_snps        1
snp_heatmap         1
snpeff              1
total               4

Select jobs to execute...

[Wed May  1 15:04:57 2024]
rule snpeff:
    input: 4_cleaned/snps.cleaned.vcf
    output: 5_snpeff/snps.annotated.vcf, 5_snpeff/snpEff_summary.html, 5_snpeff/snpEff_genes.txt
    log: 5_snpeff/snakemake.err
    jobid: 12
    reason: Missing output files: 5_snpeff/snps.annotated.vcf; Code has changed since last execution
    resources: tmpdir=/tmp

[Wed May  1 15:10:23 2024]
Finished job 12.
1 of 4 steps (25%) done
Select jobs to execute...

[Wed May  1 15:10:28 2024]
rule snp_heatmap:
    input: 5_snpeff/snps.annotated.vcf
    output: 7_heatmap/snps_heatmap.png
    jobid: 27
    reason: Missing output files: 7_heatmap/snps_heatmap.png; Input files updated by another job: 5_snpeff/snps.annotated.vcf
    resources: tmpdir=/tmp

RuleException in rule snp_heatmap in file /data/leuven/362/vsc36251/Assignment2/snakefile, line 151:
NameError: The name 'print $1,$(NF-1),$NF' is unknown in this context. Please make sure that you defined that variable. Also note that braces not used for variable access have to be escaped by repeating them, i.e. {{print $1}}, when formatting the following:

        bcftools query -l {input.vcf} > samples.txt
        bcftools query -f '%CHROM	%POS[	%GT]
' {input.vcf} | grep -v '#' | cut -f 3- > genotypes.txt
        paste samples.txt genotypes.txt | awk '{print $1,$(NF-1),$NF}' | sort | uniq -c | awk '{print $2,$3,$1}' > snps_per_individual.txt
        awk '{print $1}' snps_per_individual.txt > individuals.txt
        awk '{print $2}' snps_per_individual.txt > snps.txt
        python heatmap.py individuals.txt snps.txt {output.heatmap_image}
        
