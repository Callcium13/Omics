SLURM_JOB_ID: 61377287
SLURM_JOB_USER: vsc36251
SLURM_JOB_ACCOUNT: lp_edu_large_omics
SLURM_JOB_NAME: fastqc1_HG00141.GRCh38DH.exome.chr21
SLURM_CLUSTER_NAME: wice
SLURM_JOB_PARTITION: batch
SLURM_NNODES: 1
SLURM_NODELIST: s28c11n4
SLURM_JOB_CPUS_PER_NODE: 1
Date: Thu May  2 02:07:32 CEST 2024
Walltime: 00-00:10:00
========================================================================
Building DAG of jobs...
Falling back to greedy scheduler because no default solver is found for pulp (you have to install either coincbc or glpk).
Using shell: /bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=1000, mem_mib=954, disk_mb=1000, disk_mib=954
Select jobs to execute...

[Thu May  2 02:07:33 2024]
rule fastqc:
    input: /staging/leuven/stg_00079/teaching/1000genomes/HG00141.GRCh38DH.exome.chr21.fq.gz
    output: 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc.zip, 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc.html, 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc/fastqc_data.txt, 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc/Images/per_base_quality.png, 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc/Images/per_base_sequence_content.png, 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc/summary.txt
    jobid: 0
    reason: Forced execution
    wildcards: sample=HG00141.GRCh38DH.exome.chr21
    resources: mem_mb=1000, mem_mib=954, disk_mb=1000, disk_mib=954, tmpdir=/tmp

Input Fastq: HG00141.GRCh38DH.exome.chr21 
application/gzip
Started analysis of HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 5% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 10% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 15% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 20% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 25% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 30% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 35% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 40% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 45% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 50% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 55% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 60% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 65% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 70% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 75% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 80% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 85% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 90% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Approx 95% complete for HG00141.GRCh38DH.exome.chr21.fq.gz
Analysis complete for HG00141.GRCh38DH.exome.chr21.fq.gz
FAIL	Per base sequence content	HG00141.GRCh38DH.exome.chr21.fq.gz
Summary contains Fails!
[Thu May  2 02:07:42 2024]
Error in rule fastqc:
    jobid: 0
    input: /staging/leuven/stg_00079/teaching/1000genomes/HG00141.GRCh38DH.exome.chr21.fq.gz
    output: 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc.zip, 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc.html, 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc/fastqc_data.txt, 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc/Images/per_base_quality.png, 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc/Images/per_base_sequence_content.png, 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc/summary.txt
    shell:
        
        export PATH=/lustre1/project/stg_00079/teaching/I0U19a_conda_2024/bin:$PATH
    
        echo "Input Fastq: HG00141.GRCh38DH.exome.chr21 "
        
        #extract the fastqc
        fastqc -o 1_fastqc /staging/leuven/stg_00079/teaching/1000genomes/HG00141.GRCh38DH.exome.chr21.fq.gz --extract

        # # Check if it is in FASTQ format
        # first_line=$(head -n 1 /staging/leuven/stg_00079/teaching/1000genomes/HG00141.GRCh38DH.exome.chr21.fq.gz)
        # third_line=$(sed -n '3p' /staging/leuven/stg_00079/teaching/1000genomes/HG00141.GRCh38DH.exome.chr21.fq.gz)

        # if ! [[ $first_line == "@"* && $second_line != "+" && $third_line == "+"* ]]; then
        #     echo "File is not in FASTQ format."
        #     false
        # fi

        # #check that file is not truncated
        # if [ $(tail -n 4 /staging/leuven/stg_00079/teaching/1000genomes/HG00141.GRCh38DH.exome.chr21.fq.gz | head -n 1 | cut -c1) = "@" ]; then
        #     echo "Fourth last line does not begin with '@'!"
        #     false
        # fi

        if grep FAIL 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc/summary.txt; then
            echo "Summary contains Fails!"
            false
        fi
        #these warnings arent severe as bias can be introduced by the adapters used
        if grep WARN 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc/summary.txt; then
            echo "Summary contains warnings!"
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job fastqc since they might be corrupted:
1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc.zip, 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc.html, 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc/fastqc_data.txt, 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc/Images/per_base_quality.png, 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc/Images/per_base_sequence_content.png, 1_fastqc/HG00141.GRCh38DH.exome.chr21_fastqc/summary.txt
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
